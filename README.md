this is purely java script implementation
